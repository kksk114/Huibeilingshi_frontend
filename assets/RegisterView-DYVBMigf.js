import{d as B,u as E,r as _,a as N,c as D,b as r,w as o,e as d,f as i,g as S,m as T,l as b,h as g,k as j,i as v,j as A,E as l,o as F,_ as I}from"./index-CV45lKxV.js";const M={class:"register-container"},$={style:{display:"flex","align-items":"center"}},h=B({__name:"RegisterView",setup(z){const w=A(),V=E(),x=_(null),s=N({username:"",email:"",password:"",confirm_password:"",confirm_code:""}),f=_(!1),p=_(!1),k={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],confirm_password:[{required:!0,message:"请确认密码",trigger:"blur"}],confirm_code:[{required:!0,message:"请输入验证码",trigger:"blur"}]},y=()=>!s.username||!s.email||!s.password||!s.confirm_password?(l.warning("请填写所有必填字段"),!1):s.password!==s.confirm_password?(l.warning("两次输入的密码不一致"),!1):!0,C=async()=>{if(y()){f.value=!0;try{const t={username:s.username,password:s.password,confirm_password:s.confirm_password,email:s.email},e=await V.sendVerificationCode(t);e&&e.message?l.success(e.message):l.success("验证码已发送！")}catch(t){console.error("发送验证码时出错:",t),l.error("发送验证码失败，请稍后重试")}finally{f.value=!1}}},R=async()=>{if(!y()||!s.confirm_code){l.warning("请填写验证码");return}p.value=!0;try{const t={username:s.username,password:s.password,email:s.email,code:s.confirm_code},e=await V.verifyRegistration(t);e&&e.isRegistered?(l.success("注册成功！即将为您跳转到登录页面"),setTimeout(()=>{w.push("/login")},2e3)):l.warning("注册失败，请检查验证码是否正确")}catch(t){console.error("注册时出错:",t),l.error("注册失败，请稍后重试")}finally{p.value=!1}};return(t,e)=>{const c=d("el-button"),u=d("el-icon"),m=d("el-input"),n=d("el-form-item"),q=d("el-form"),U=d("el-card");return F(),D("div",M,[r(U,{class:"register-card"},{header:o(()=>[v("div",$,[r(c,{onClick:e[0]||(e[0]=a=>i(w).push("/login")),type:"primary",class:"back-button"},{default:o(()=>e[6]||(e[6]=[g("返回登录")])),_:1}),e[7]||(e[7]=v("h2",{style:{"margin-left":"40px"}},"用户注册",-1))])]),default:o(()=>[r(q,{model:s,rules:k,ref_key:"formRef",ref:x},{default:o(()=>[r(n,{label:"用户名",prop:"username"},{default:o(()=>[r(m,{modelValue:s.username,"onUpdate:modelValue":e[1]||(e[1]=a=>s.username=a),placeholder:"用户名"},{prefix:o(()=>[r(u,null,{default:o(()=>[r(i(S))]),_:1})]),_:1},8,["modelValue"])]),_:1}),r(n,{label:"邮箱",prop:"email"},{default:o(()=>[r(m,{modelValue:s.email,"onUpdate:modelValue":e[2]||(e[2]=a=>s.email=a),placeholder:"邮箱"},{prefix:o(()=>[r(u,null,{default:o(()=>[r(i(T))]),_:1})]),_:1},8,["modelValue"])]),_:1}),r(n,{label:"密码",prop:"password"},{default:o(()=>[r(m,{type:"password",modelValue:s.password,"onUpdate:modelValue":e[3]||(e[3]=a=>s.password=a),placeholder:"密码"},{prefix:o(()=>[r(u,null,{default:o(()=>[r(i(b))]),_:1})]),_:1},8,["modelValue"])]),_:1}),r(n,{label:"确认密码",prop:"confirm_password"},{default:o(()=>[r(m,{type:"password",modelValue:s.confirm_password,"onUpdate:modelValue":e[4]||(e[4]=a=>s.confirm_password=a),placeholder:"确认密码"},{prefix:o(()=>[r(u,null,{default:o(()=>[r(i(b))]),_:1})]),_:1},8,["modelValue"])]),_:1}),r(n,null,{default:o(()=>[r(c,{type:"primary",onClick:C,style:{width:"100%"},loading:f.value},{default:o(()=>e[8]||(e[8]=[g("发送验证码")])),_:1},8,["loading"])]),_:1}),r(n,{label:"验证码",prop:"confirm_code"},{default:o(()=>[r(m,{modelValue:s.confirm_code,"onUpdate:modelValue":e[5]||(e[5]=a=>s.confirm_code=a),placeholder:"验证码"},{prefix:o(()=>[r(u,null,{default:o(()=>[r(i(j))]),_:1})]),_:1},8,["modelValue"])]),_:1}),r(n,null,{default:o(()=>[r(c,{type:"success",onClick:R,style:{width:"100%"},loading:p.value},{default:o(()=>e[9]||(e[9]=[g("注册")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})])}}}),H=I(h,[["__scopeId","data-v-4b5abd84"]]);export{H as default};
