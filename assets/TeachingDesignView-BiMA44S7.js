import{d as L,a as T,r as g,L as q,c as b,b as t,w as l,e as i,t as V,M,h as y,f as _,K as x,i as n,x as k,N as P,O as R,P as F,E as C,Q as K,o as f,_ as Q}from"./index-CV45lKxV.js";const S={class:"teaching-design"},$={class:"card-header"},z={key:0,class:"loading-container"},A={key:1,class:"outline-container"},G={class:"outline-header"},H={class:"file-name"},J={class:"outline-preview"},W=["src"],X={key:1,class:"no-preview"},Y={class:"outline-actions"},Z=L({__name:"TeachingDesignView",setup(ee){const o=T({courseName:"",objective:"",content:"",request:""}),w=g(!1),p=g(0),c=g(""),s=g(""),m=g(""),N=q(()=>{var e;const a=(e=s.value.split(".").pop())==null?void 0:e.toLowerCase();return["pdf","txt","html"].includes(a||"")}),U=async()=>{if(!o.courseName){C.warning("请输入课程名称");return}w.value=!0,p.value=0,c.value="",s.value="",m.value="";const a=setInterval(()=>{p.value<90&&(p.value+=10)},1e3);try{const e=await K.post("/api/static/teach",{suggestion:"人工智能时代-课程教学大纲"},{responseType:"blob"}),u=e.headers["content-disposition"];if(u){const r=u.match(/filename="?([^"]*)"?/);r&&r[1]?s.value=r[1]:s.value="人工智能时代-课程教学大纲.pdf"}else s.value="人工智能时代-课程教学大纲.pdf";const v=new Blob([e.data],{type:e.headers["content-type"]||"application/octet-stream"});c.value=URL.createObjectURL(v),p.value=100,C.success("教案生成成功")}catch(e){console.error("生成教案失败:",e),m.value="生成教案失败，请重试",p.value=0}finally{clearInterval(a),w.value=!1}},B=()=>{if(!c.value)return;const a=document.createElement("a");a.href=c.value,a.download=s.value,document.body.appendChild(a),a.click(),document.body.removeChild(a)},O=()=>{c.value="",s.value="",m.value=""};return(a,e)=>{const u=i("el-icon"),v=i("el-input"),r=i("el-form-item"),h=i("el-button"),j=i("el-form"),D=i("el-progress"),E=i("el-alert"),I=i("el-card");return f(),b("div",S,[t(I,{class:"design-card"},{header:l(()=>[n("div",$,[n("h2",null,[t(u,null,{default:l(()=>[t(_(F))]),_:1}),e[5]||(e[5]=y(" 教学设计"))])])]),default:l(()=>[t(j,{model:o,"label-width":"120px"},{default:l(()=>[t(r,{label:"课程名称"},{default:l(()=>[t(v,{modelValue:o.courseName,"onUpdate:modelValue":e[0]||(e[0]=d=>o.courseName=d),placeholder:"请输入课程名称"},null,8,["modelValue"])]),_:1}),t(r,{label:"教学目标"},{default:l(()=>[t(v,{modelValue:o.objective,"onUpdate:modelValue":e[1]||(e[1]=d=>o.objective=d),type:"textarea",placeholder:"请输入教学目标"},null,8,["modelValue"])]),_:1}),t(r,{label:"教学内容"},{default:l(()=>[t(v,{modelValue:o.content,"onUpdate:modelValue":e[2]||(e[2]=d=>o.content=d),type:"textarea",rows:"4",placeholder:"请输入教学内容"},null,8,["modelValue"])]),_:1}),t(r,{label:"其他要求"},{default:l(()=>[t(v,{modelValue:o.request,"onUpdate:modelValue":e[3]||(e[3]=d=>o.request=d),type:"textarea",rows:"4",placeholder:"请输入其他要求（可选）"},null,8,["modelValue"])]),_:1}),t(r,null,{default:l(()=>[t(h,{type:"primary",onClick:U,loading:w.value,class:"generate-btn"},{default:l(()=>[t(u,null,{default:l(()=>[t(_(x))]),_:1}),e[6]||(e[6]=y(" 生成教案 "))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),w.value?(f(),b("div",z,[t(D,{type:"circle",percentage:p.value,"stroke-width":8,width:120,status:"success"},null,8,["percentage"]),e[7]||(e[7]=n("p",{class:"loading-text"},"正在生成教案，请稍候...",-1))])):V("",!0),c.value?(f(),b("div",A,[n("div",G,[n("h2",null,[t(u,null,{default:l(()=>[t(_(x))]),_:1}),e[8]||(e[8]=y(" 教案文件"))]),n("span",H,k(s.value),1)]),n("div",J,[N.value?(f(),b("iframe",{key:0,src:c.value,width:"100%",height:"500px"},null,8,W)):(f(),b("div",X,[t(u,null,{default:l(()=>[t(_(x))]),_:1}),n("p",null,k(s.value),1),e[9]||(e[9]=n("span",{class:"preview-hint"},"此文件类型无法预览",-1))]))]),n("div",Y,[t(h,{type:"primary",onClick:B,class:"action-btn"},{default:l(()=>[t(u,null,{default:l(()=>[t(_(P))]),_:1}),e[10]||(e[10]=y(" 下载教案 "))]),_:1}),t(h,{onClick:O,class:"action-btn"},{default:l(()=>[t(u,null,{default:l(()=>[t(_(R))]),_:1}),e[11]||(e[11]=y(" 清除教案 "))]),_:1})])])):V("",!0),m.value?(f(),M(E,{key:2,title:m.value,type:"error","show-icon":"",closable:!0,onClose:e[4]||(e[4]=d=>m.value=""),class:"error-alert"},null,8,["title"])):V("",!0)]),_:1})])}}}),le=Q(Z,[["__scopeId","data-v-de9cd9e1"]]);export{le as default};
