import{_ as q,r as u,L as H,p as K,c as b,b as a,w as s,i as l,h as o,e as g,f as d,S as L,x as k,M as x,t as w,T as C,U as N,V as $,W as Q,E as p,o as i,X as Y,J as Z}from"./index-CV45lKxV.js";const ee={class:"ai-classroom"},ae={class:"card-header"},se={class:"class-info"},le={class:"left-info"},te={class:"teaching-controls"},oe={class:"section-header"},ne={class:"video-container"},ue={key:0,id:"myVideo",class:"student-video",controls:"",preload:"auto"},de=["src"],re={key:1,class:"video-placeholder"},ie={class:"student-response-area"},ce={class:"response-text"},ve={class:"section-header"},pe={class:"upload-container"},fe={class:"audio-controls"},_e={class:"audio-status"},me={key:0,class:"audio-length"},ye={class:"audio-buttons"},ge={key:0,class:"audio-preview"},he=["src"],be={__name:"AiClassView",setup(ke){const c=u(!1),h=u(0),m=u(null),V=u(""),B=["我明白了，老师讲得很清楚！","这个知识点有点难，能再讲一遍吗？","老师，我有个问题想问一下...","这个例子非常形象，我理解了！"],I=u(""),E=u(""),z=u([]),j=H(()=>{const n=Math.floor(h.value/3600),e=Math.floor(h.value%3600/60),t=h.value%60;return`${n.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}),D=async()=>{if(c.value)return;const n=Y.service({lock:!0,text:"正在加载视频资源...",background:"rgba(0, 0, 0, 0.7)"});try{I.value="/videos/演示视频1.mp4",c.value=!0,m.value=setInterval(()=>{h.value++},1e3),setInterval(()=>{if(Math.random()>.7){const t=Math.floor(Math.random()*B.length);V.value=B[t],setTimeout(()=>{V.value=""},3e3)}},5e3),await Z();const e=document.getElementById("myVideo");e&&(e.load(),e.play().catch(t=>{console.error("视频自动播放失败:",t),p.info("请点击视频开始播放")})),p.success("课堂已开始")}catch(e){console.error("加载视频失败:",e),p.error("加载视频资源失败，请重试")}finally{n.close()}},O=()=>{c.value&&(m.value&&(clearInterval(m.value),m.value=null),c.value=!1,h.value=0,V.value="",I.value="",p.success("课堂已结束"))},P=n=>{z.value=[n],p.success(`文件 ${n.name} 已选择`)},M=()=>{p.success("生成数字人视频成功")},_=u(!1),v=u(""),R=u(0),r=u(null),T=u([]),S=u(null),F=async()=>{if(_.value){A();return}try{const n=await navigator.mediaDevices.getUserMedia({audio:!0});r.value=new MediaRecorder(n),T.value=[],r.value.ondataavailable=t=>{t.data.size>0&&T.value.push(t.data)},r.value.onstop=()=>{const t=new Blob(T.value,{type:"audio/webm"});v.value&&URL.revokeObjectURL(v.value),v.value=URL.createObjectURL(t),_.value=!1,p.success("录音已完成")},r.value.start(),_.value=!0,R.value=0;const e=setInterval(()=>{R.value++},1e3);r.value.audioTimer=e,p.success("开始录音")}catch(n){console.error("无法访问麦克风:",n),p.error("无法访问麦克风，请检查权限设置")}},A=()=>{var n;r.value&&_.value&&(r.value.stop(),(n=r.value.stream)==null||n.getTracks().forEach(e=>e.stop()),r.value.audioTimer&&clearInterval(r.value.audioTimer))},G=()=>{v.value&&S.value&&S.value.play()};return K(()=>()=>{m.value&&clearInterval(m.value)}),(n,e)=>{const t=g("el-icon"),U=g("el-tag"),f=g("el-button"),y=g("el-card"),J=g("el-input"),W=g("el-upload");return i(),b("div",ee,[a(y,{class:"classroom-header",shadow:"hover"},{default:s(()=>[l("div",ae,[l("h2",null,[a(t,null,{default:s(()=>[a(d(L))]),_:1}),e[1]||(e[1]=o(" AI在线课堂"))])]),l("div",se,[l("div",le,[a(U,{type:c.value?"success":"info",size:"default",class:"status-tag"},{default:s(()=>[o(k(c.value?"正在上课":"尚未上课"),1)]),_:1},8,["type"]),a(U,{type:"info",size:"small",class:"timer-tag"},{default:s(()=>[o(k(j.value),1)]),_:1})]),l("div",te,[c.value?w("",!0):(i(),x(f,{key:0,type:"success",class:"start-class-btn",onClick:D},{default:s(()=>[a(t,null,{default:s(()=>[a(d(C))]),_:1}),e[2]||(e[2]=o(" 开始上课 "))]),_:1})),c.value?(i(),x(f,{key:1,type:"danger",class:"control-btn end-class",onClick:O},{default:s(()=>[a(t,null,{default:s(()=>[a(d(N))]),_:1}),e[3]||(e[3]=o(" 结束课程 "))]),_:1})):w("",!0)])])]),_:1}),a(y,{class:"student-section",shadow:"hover"},{default:s(()=>[l("div",oe,[l("h3",null,[a(t,null,{default:s(()=>[a(d(L))]),_:1}),e[4]||(e[4]=o(" 数字人课堂"))])]),l("div",ne,[c.value?(i(),b("video",ue,[l("source",{src:I.value,type:"video/mp4"},null,8,de),e[5]||(e[5]=o(" 您的浏览器不支持视频播放 "))])):(i(),b("div",re,[a(t,{class:"video-icon"},{default:s(()=>[a(d(L))]),_:1}),e[6]||(e[6]=l("p",null,"等待开始上课...",-1))]))]),l("div",ie,[l("p",ce,k(V.value||"学生正在听课..."),1)])]),_:1}),a(y,{class:"upload-section",shadow:"hover"},{default:s(()=>[l("div",ve,[l("h3",null,[a(t,null,{default:s(()=>[a(d($))]),_:1}),e[7]||(e[7]=o(" 内容生成"))])]),l("div",pe,[a(y,{class:"upload-box",shadow:"hover"},{header:s(()=>e[8]||(e[8]=[l("div",{class:"upload-box-header"},[l("h4",null,"文字生成视频")],-1)])),default:s(()=>[a(J,{modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=X=>E.value=X),type:"textarea",rows:3,placeholder:"请输入数字人讲授的文本",class:"text-input"},null,8,["modelValue"]),a(f,{type:"primary",onClick:M,class:"generate-btn"},{default:s(()=>[a(t,null,{default:s(()=>[a(d(C))]),_:1}),e[9]||(e[9]=o(" 生成视频 "))]),_:1})]),_:1}),a(y,{class:"upload-box",shadow:"hover"},{header:s(()=>e[10]||(e[10]=[l("div",{class:"upload-box-header"},[l("h4",null,"教案生成视频")],-1)])),default:s(()=>[a(W,{class:"upload-demo",drag:"",action:"#","auto-upload":!1,"on-change":P,"file-list":z.value},{default:s(()=>[a(t,{class:"el-icon--upload"},{default:s(()=>[a(d($))]),_:1}),e[11]||(e[11]=l("div",{class:"el-upload__text"},[o(" 将文件拖到此处，或"),l("em",null,"点击上传")],-1))]),_:1},8,["file-list"]),a(f,{type:"primary",onClick:M,class:"generate-btn"},{default:s(()=>[a(t,null,{default:s(()=>[a(d(C))]),_:1}),e[12]||(e[12]=o(" 生成视频 "))]),_:1})]),_:1}),a(y,{class:"upload-box audio-box",shadow:"hover"},{header:s(()=>e[13]||(e[13]=[l("div",{class:"upload-box-header"},[l("h4",null,"创建新音色")],-1)])),default:s(()=>[l("div",fe,[l("div",_e,[a(U,{type:_.value?"danger":"info",size:"large",class:"recording-tag"},{default:s(()=>[o(k(_.value?"录音中...":"未开始录音"),1)]),_:1},8,["type"]),v.value?(i(),b("span",me,"录音长度: "+k(R.value)+"秒",1)):w("",!0)]),l("div",ye,[_.value?(i(),x(f,{key:1,type:"danger",onClick:A,class:"audio-btn"},{default:s(()=>[a(t,null,{default:s(()=>[a(d(N))]),_:1}),e[15]||(e[15]=o(" 停止录音 "))]),_:1})):(i(),x(f,{key:0,type:"primary",onClick:F,class:"audio-btn"},{default:s(()=>[a(t,null,{default:s(()=>[a(d(Q))]),_:1}),e[14]||(e[14]=o(" 开始录音 "))]),_:1})),v.value?(i(),x(f,{key:2,type:"success",onClick:G,class:"audio-btn"},{default:s(()=>[a(t,null,{default:s(()=>[a(d(C))]),_:1}),e[16]||(e[16]=o(" 播放录音 "))]),_:1})):w("",!0),a(f,{type:"primary",disabled:!v.value,onClick:M,class:"audio-btn"},{default:s(()=>[a(t,null,{default:s(()=>[a(d(C))]),_:1}),e[17]||(e[17]=o(" 生成视频 "))]),_:1},8,["disabled"])])]),v.value?(i(),b("div",ge,[l("audio",{ref_key:"audioPlayer",ref:S,controls:"",src:v.value},null,8,he)])):w("",!0)]),_:1})])]),_:1})])}}},we=q(be,[["__scopeId","data-v-3a4054ad"]]);export{we as default};
